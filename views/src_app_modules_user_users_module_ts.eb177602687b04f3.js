"use strict";(self.webpackChunkaed_portal=self.webpackChunkaed_portal||[]).push([["src_app_modules_user_users_module_ts"],{9460:(N,p,a)=>{a.r(p),a.d(p,{UsersModule:()=>F});var m=a(8692),c=a(458),r=a(9900),g=a(5128),u=a(8629),h=a(574),e=a(7241),f=a(1383),_=a(7556);function Z(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tbody")(1,"tr")(2,"td",11)(3,"h6",12),e._uU(4),e.qZA()(),e.TgZ(5,"td",11)(6,"h6",12),e._uU(7),e.qZA()(),e.TgZ(8,"td",11)(9,"h6",12),e._uU(10),e.qZA()(),e.TgZ(11,"td",11)(12,"h6",12),e._uU(13),e.qZA()(),e.TgZ(14,"td",11)(15,"h6",12),e._uU(16),e.qZA()(),e.TgZ(17,"td",11)(18,"h6",12),e._uU(19),e.qZA()(),e.TgZ(20,"td",11)(21,"i",53),e.NdJ("click",function(){const n=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.EditUser(n,"user-modal"))}),e.qZA()(),e.TgZ(22,"td",11)(23,"i",54),e.NdJ("click",function(){const n=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.SelectUserToDelete(n,"delete-user-modal"))}),e.qZA()(),e.TgZ(24,"td",11)(25,"h6",12)(26,"span",55),e._uU(27),e.qZA()()(),e.TgZ(28,"td",11)(29,"h6",12)(30,"span",55),e._uU(31),e.qZA()()()()()}if(2&o){const t=i.$implicit,s=i.index;e.xp6(4),e.Oqu(t.id),e.xp6(3),e.Oqu(s+1),e.xp6(3),e.Oqu(t.username),e.xp6(3),e.Oqu(t.fullname),e.xp6(3),e.Oqu(t.email),e.xp6(3),e.Oqu(t.roles),e.xp6(8),e.Oqu(t.isActive?"":"\u2713"),e.xp6(4),e.Oqu(t.isSuperAdmin?"":"\u2713")}}function U(o,i){1&o&&(e.TgZ(0,"label",56),e._uU(1,"Username"),e.qZA())}function b(o,i){1&o&&(e.TgZ(0,"label",57),e._uU(1,"Full Name"),e.qZA())}function A(o,i){1&o&&(e.TgZ(0,"label",58),e._uU(1,"Email"),e.qZA())}function v(o,i){1&o&&(e.TgZ(0,"label",59),e._uU(1,"Password"),e.qZA())}function T(o,i){1&o&&(e.TgZ(0,"label",60),e._uU(1,"Password COnfirm"),e.qZA())}function C(o,i){1&o&&(e.TgZ(0,"div",61),e._uU(1," Password does not match "),e.qZA())}function q(o,i){1&o&&(e.TgZ(0,"label",60),e._uU(1,"R\xf4les"),e.qZA())}function w(o,i){if(1&o&&(e.TgZ(0,"option",62),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.s9C("value",t),e.xp6(1),e.hij(" ",t," ")}}const M=[{path:"",component:(()=>{class o{constructor(t,s,l){this.store=t,this.auth=s,this.router=l,this.users$=[{id:"any",username:"string",fullname:"string",email:"string",roles:["1","2","3"],isActive:!0,dhisusersession:"string",defaultRedirectUrl:"string"}],this.roles$=[],this.isLoginForm=!1,this.isLoading=!1,this.LoadingMsg="Loading...",this.isEditMode=!1,this.message="",this.APP_LOGO=g.z.APP_LOGO,this.roles=new h.G(this.store)}activeSave(){throw new Error("Method not implemented.")}ngOnInit(){this.getUsers(),this.userForm=this.createFormGroup()}getUsers(){this.auth.getAllUsers().subscribe(t=>{if(200===t.status){this.users$=[];const s=t.data;for(let l=0;l<s.length;l++)this.users$.push(s[l])}else console.log(t.data)},t=>{console.log(t.error)})}EditUser(t,s){this.isEditMode=!0,t.roles=t.roles.toString().replace("[","").replace("]","").split(","),this.userForm=this.createFormGroup(t),this.user=t,this.showModal(s)}SelectUserToDelete(t,s){this.user=t,this.showModal(s)}DeleteUser(){this.isEditMode=!1,this.user&&this.auth.deleteUser(this.user).subscribe(t=>{200===t.status?(this.getUsers(),this.user=null,this.isLoading=!1):this.message=t.data,console.log(this.message)},t=>{this.message=t,this.isLoading=!1,console.log(this.message)})}CreateUser(t){this.showModal(t),this.isEditMode=!1,this.userForm=this.createFormGroup(),this.user=null}createFormGroup(t){return new r.cw({username:new r.NI(null!=t?t.username:"",[r.kI.required,r.kI.minLength(4)]),fullname:new r.NI(null!=t?t.fullname:"",[r.kI.required,r.kI.minLength(4)]),password:new r.NI("",this.isEditMode?[]:[r.kI.required,r.kI.minLength(8)]),passwordConfirm:new r.NI("",this.isEditMode?[]:[r.kI.required,r.kI.minLength(8)]),roles:new r.NI(null!=t?t.roles:"",[r.kI.required,r.kI.minLength(1)]),isActive:new r.NI(null!=t&&t.isActive)},[this.MatchValidator("password","passwordConfirm")])}passwordMatchError(){return this.userForm.getError("password")&&this.userForm.get("passwordConfirm")?.touched}showModal(t){showAppModal(t)}closeModal(t){closeAppModal(t)}MatchValidator(t,s){return l=>{const n=l.get(t),d=l.get(s);if(n&&d){if(n.value!==d.value)return{mismatch:!0};if(this.isEditMode&&((0,u.Nf)(n.value)&&n.value.length<8||(0,u.Nf)(d.value)&&d.value.length<8))return{mismatch:!0}}return null}}register(t){if(this.auth.isLoggedIn()){if(this.isEditMode){const s=(0,u.Nf)(this.userForm.value.password)&&(0,u.Nf)(this.userForm.value.passwordConfirm);this.userForm.value.editPassword=s,this.userForm.value.id=this.user.id}return(this.isEditMode?this.auth.updateUser(this.userForm.value):this.auth.register(this.userForm.value)).subscribe(s=>{200===s.status?(this.message="Registed successfully !",this.closeModal(t),console.log("successfully !"),this.getUsers()):this.message=s.data,console.log(this.message),this.isLoading=!1},s=>{this.isLoading=!1})}this.auth.logout()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.u),e.Y36(_.e),e.Y36(c.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user"]],decls:109,vars:22,consts:[[1,"row"],[1,"col-lg-12","d-flex","align-items-stretch"],[1,"card","w-100"],[1,"card-body","p-4"],[1,"card-title","fw-semibold"],[1,"card-body"],[1,"fas","fa-user",2,"float","left"],["type","button","data-toggle","modal","data-target","#modal-default",1,"btn","btn-success","m-1",2,"float","right",3,"click"],[1,"table-responsive"],[1,"table","text-nowrap","mb-0","align-middle"],[1,"text-dark","fs-4"],[1,"border-bottom-0"],[1,"fw-semibold","mb-0"],["colspan","2",1,"border-bottom-0"],[4,"ngFor","ngForOf"],["id","user-modal","aria-hidden","true",1,"modal","micromodal-slide"],["tabindex","-1","data-micromodal-close","",1,"modal__overlay"],["role","dialog","aria-modal","true","aria-labelledby","user-modal-title",1,"modal__container"],["novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"modal__header"],["id","user-modal-title",1,"modal__title"],["height","30","alt","","srcset","",1,"modal-title",3,"src"],[1,"login-box-msg",2,"text-align","center"],["aria-label","Close modal","data-micromodal-close","",1,"modal__close"],["id","user-modal-content",1,"modal__content"],[1,"login-box-msg",2,"width","500px"],["for","username",4,"ngIf"],[1,"input-group","mb-3"],["id","username","type","text","placeholder","Username","formControlName","username",1,"form-control"],["for","fullname",4,"ngIf"],["id","fullname","type","text","placeholder","Full Name","formControlName","fullname",1,"form-control"],["for","email",4,"ngIf"],["id","email","type","email","placeholder","Email","formControlName","email",1,"form-control"],["for","password",4,"ngIf"],["id","password","type","password","placeholder","Password","formControlName","password",1,"form-control"],["for","passwordConfirm",4,"ngIf"],["id","passwordConfirm","type","password","placeholder","Retype password","formControlName","passwordConfirm",1,"form-control"],["class","btn btn-danger",4,"ngIf"],["multiple","multiple","formControlName","roles",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-6"],[1,"icheck-primary"],["type","checkbox","id","isActive","formControlName","isActive"],["for","isActive"],[1,"modal__footer"],["data-micromodal-close","","aria-label","Close this dialog window",1,"modal__btn"],["type","submit",2,"float","right",3,"disabled"],["id","delete-user-modal","aria-hidden","true",1,"modal","micromodal-slide"],["role","dialog","aria-modal","true","aria-labelledby","delete-user-modal-title",1,"modal__container"],["id","delete-user-modal-title",1,"modal__title"],["id","delete-user-modal-content",1,"modal__content"],[1,"login-box-msg"],[1,"modal__btn","modal__btn-danger",2,"float","right",3,"click"],[1,"ti","ti-edit",2,"font-size","30px","cursor","pointer","color","orange",3,"click"],[1,"ti","ti-trash",2,"font-size","30px","cursor","pointer","color","red",3,"click"],[2,"font-size","20px"],["for","username"],["for","fullname"],["for","email"],["for","password"],["for","passwordConfirm"],[1,"btn","btn-danger"],[3,"value"]],template:function(t,s){1&t&&(e._UZ(0,"br")(1,"br")(2,"br"),e.TgZ(3,"div",0)(4,"div",1)(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"span",6),e._uU(10," Users List"),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return s.CreateUser("user-modal")}),e._uU(12," Add User "),e.qZA()()(),e.TgZ(13,"div",8)(14,"table",9)(15,"thead",10)(16,"tr")(17,"th",11)(18,"h6",12),e._uU(19,"id"),e.qZA()(),e.TgZ(20,"th",11)(21,"h6",12),e._uU(22,"N\xb0"),e.qZA()(),e.TgZ(23,"th",11)(24,"h6",12),e._uU(25,"Username"),e.qZA()(),e.TgZ(26,"th",11)(27,"h6",12),e._uU(28,"Full name"),e.qZA()(),e.TgZ(29,"th",11)(30,"h6",12),e._uU(31,"Email"),e.qZA()(),e.TgZ(32,"th",11)(33,"h6",12),e._uU(34,"Role"),e.qZA()(),e.TgZ(35,"th",13)(36,"h6",12),e._uU(37,"Actions"),e.qZA()(),e.TgZ(38,"th",11)(39,"h6",12),e._uU(40,"InActifs"),e.qZA()(),e.TgZ(41,"th",11)(42,"h6",12),e._uU(43,"IsSuperAdmin"),e.qZA()()()(),e.YNc(44,Z,32,8,"tbody",14),e.qZA()()()()()(),e.TgZ(45,"div",15)(46,"div",16)(47,"div",17)(48,"form",18),e.NdJ("ngSubmit",function(){return s.register("user-modal")}),e.TgZ(49,"header",19)(50,"h2",20),e._UZ(51,"img",21),e.TgZ(52,"strong",22)(53,"span"),e._uU(54),e.qZA()()(),e._UZ(55,"button",23),e.qZA(),e.TgZ(56,"main",24)(57,"p",25)(58,"strong"),e._uU(59),e.qZA()(),e.YNc(60,U,2,0,"label",26),e.TgZ(61,"div",27),e._UZ(62,"input",28),e.qZA(),e.YNc(63,b,2,0,"label",29),e.TgZ(64,"div",27),e._UZ(65,"input",30),e.qZA(),e.YNc(66,A,2,0,"label",31),e.TgZ(67,"div",27),e._UZ(68,"input",32),e.qZA(),e.YNc(69,v,2,0,"label",33),e.TgZ(70,"div",27),e._UZ(71,"input",34),e.qZA(),e.YNc(72,T,2,0,"label",35),e.TgZ(73,"div",27),e._UZ(74,"input",36),e.qZA(),e.YNc(75,C,2,0,"div",37),e.YNc(76,q,2,0,"label",35),e.TgZ(77,"div",27)(78,"select",38),e.YNc(79,w,2,2,"option",39),e.qZA()(),e.TgZ(80,"div",0)(81,"div",40)(82,"div",27)(83,"div",41),e._UZ(84,"input",42),e.TgZ(85,"label",43),e._uU(86,"Activer"),e.qZA()()()()()(),e.TgZ(87,"footer",44)(88,"button",45),e._uU(89,"Close"),e.qZA(),e.TgZ(90,"button",46),e._uU(91),e.qZA()()()()()(),e.TgZ(92,"div",47)(93,"div",16)(94,"div",48)(95,"header",19)(96,"h2",49),e._uU(97," Suppression d'utilisateur "),e.qZA(),e._UZ(98,"button",23),e.qZA(),e.TgZ(99,"main",50),e._uU(100," Cette action est ir\xe9versible! \xcates vous s\xfbr de proc\xe9der \xe0 la suppression ? "),e.TgZ(101,"p",51)(102,"strong"),e._uU(103),e.qZA()()(),e.TgZ(104,"footer",44)(105,"button",45),e._uU(106,"Annuler"),e.qZA(),e.TgZ(107,"button",52),e.NdJ("click",function(){return s.DeleteUser()}),e._uU(108,"Oui Supprimer"),e.qZA()()()()()),2&t&&(e.xp6(44),e.Q6J("ngForOf",s.users$),e.xp6(4),e.Q6J("formGroup",s.userForm),e.xp6(3),e.s9C("src",s.APP_LOGO,e.LSH),e.xp6(2),e.Gre(" btn-",s.isEditMode?"warning":"success",""),e.xp6(1),e.Oqu(s.isEditMode?"Modifier un utilisateur":"Ajouter un utilisateur"),e.xp6(5),e.Oqu(s.message),e.xp6(1),e.Q6J("ngIf",s.isEditMode),e.xp6(3),e.Q6J("ngIf",s.isEditMode),e.xp6(3),e.Q6J("ngIf",s.isEditMode),e.xp6(3),e.Q6J("ngIf",s.isEditMode),e.xp6(3),e.Q6J("ngIf",s.isEditMode),e.xp6(3),e.Q6J("ngIf",s.passwordMatchError()),e.xp6(1),e.Q6J("ngIf",s.isEditMode),e.xp6(3),e.Q6J("ngForOf",s.roles$),e.xp6(11),e.Gre("modal__btn modal__btn-",s.isEditMode?"warning":"primary",""),e.Q6J("disabled",!s.userForm.valid),e.xp6(1),e.Oqu(s.isEditMode?"Modifier":"Sauvegarder"),e.xp6(12),e.Oqu(s.message))},dependencies:[m.sg,m.O5,r._Y,r.YN,r.Kr,r.Fj,r.Wl,r.K7,r.JJ,r.JL,r.sg,r.u],encapsulation:2}),o})(),data:{href:"user",icon:"fa fa-user",label:"Users",title:"Users"}}];let x=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[c.Bz.forChild(M),c.Bz]}),o})(),F=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.ez,r.UX,x]}),o})()}}]);